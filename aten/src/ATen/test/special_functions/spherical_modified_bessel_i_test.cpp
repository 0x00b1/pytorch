#include <gtest/gtest.h>
#include <ATen/native/special_functions/spherical_modified_bessel_i.h>

template<typename T1>
struct spherical_modified_bessel_i_fixture {
  T1 f0;
  unsigned int n;
  T1 x;
  T1 f;
};

const spherical_modified_bessel_i_fixture<double> fixture_0001[21] = {
    {1.0000000000000000, 0, 0.0000000000000000, 0.0},
    {1.0104492672326733, 0, 0.25000000000000000, 0.0},
    {1.0421906109874948, 0, 0.50000000000000000, 0.0},
    {1.0964223092477734, 0, 0.75000000000000000, 0.0},
    {1.1752011936438014, 0, 1.0000000000000000, 0.0},
    {1.2815352642406606, 0, 1.2500000000000000, 0.0},
    {1.4195196367298781, 0, 1.5000000000000000, 0.0},
    {1.5945224950157957, 0, 1.7500000000000000, 0.0},
    {1.8134302039235093, 0, 2.0000000000000000, 0.0},
    {2.0849636915103695, 0, 2.2500000000000000, 0.0},
    {2.4200817924159148, 0, 2.5000000000000000, 0.0},
    {2.8324916405420844, 0, 2.7500000000000000, 0.0},
    {3.3392916424699672, 0, 3.0000000000000000, 0.0},
    {3.9617793399017449, 0, 3.2500000000000000, 0.0},
    {4.7264649393242850, 0, 3.5000000000000000, 0.0},
    {5.6663419005609041, 0, 3.7500000000000000, 0.0},
    {6.8224792992819374, 0, 4.0000000000000000, 0.0},
    {8.2460174250328073, 0, 4.2500000000000000, 0.0},
    {10.000669144887063, 0, 4.5000000000000000, 0.0},
    {12.165856087577321, 0, 4.7500000000000000, 0.0},
    {14.840642115557751, 0, 5.0000000000000000, 0.0},
};

const double tolerance_0001 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0002[21] = {
    {0.0000000000000000, 1, 0.0000000000000000, 0.0},
    {0.083855330587599780, 1, 0.25000000000000000, 0.0},
    {0.17087070843777219, 1, 0.50000000000000000, 0.0},
    {0.26434796723876192, 1, 0.75000000000000000, 0.0},
    {0.36787944117144250, 1, 1.0000000000000000, 0.0},
    {0.48551089033628403, 1, 1.2500000000000000, 0.0},
    {0.62192665234224598, 1, 1.5000000000000000, 0.0},
    {0.78266617983559550, 1, 1.7500000000000000, 0.0},
    {0.97438274358006116, 1, 2.0000000000000000, 0.0},
    {1.2051572617554782, 1, 2.2500000000000000, 0.0},
    {1.4848830748991084, 1, 2.5000000000000000, 0.0},
    {1.8257411753292201, 1, 2.7500000000000000, 0.0},
    {2.2427901177692657, 1, 3.0000000000000000, 0.0},
    {2.7547008377263529, 1, 3.2500000000000000, 0.0},
    {3.3846742090665800, 1, 3.5000000000000000, 0.0},
    {4.1615887926395976, 1, 3.7500000000000000, 0.0},
    {5.1214383841836364, 1, 4.0000000000000000, 0.0},
    {6.3091343212389708, 1, 4.2500000000000000, 0.0},
    {7.7807668896984357, 1, 4.5000000000000000, 0.0},
    {9.6064446365511706, 1, 4.7500000000000000, 0.0},
    {11.873861281846017, 1, 5.0000000000000000, 0.0},
};

const double tolerance_0002 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0003[21] = {
    {0.0000000000000000, 2, 0.0000000000000000, 0.0},
    {0.0041853001814763620, 2, 0.25000000000000000, 0.0},
    {0.016966360360862322, 2, 0.50000000000000000, 0.0},
    {0.039030440292726704, 2, 0.75000000000000000, 0.0},
    {0.071562870129473932, 2, 1.0000000000000000, 0.0},
    {0.11630912743357828, 2, 1.2500000000000000, 0.0},
    {0.17566633204538651, 2, 1.5000000000000000, 0.0},
    {0.25280904386906089, 2, 1.7500000000000000, 0.0},
    {0.35185608855341760, 2, 2.0000000000000000, 0.0},
    {0.47808734250306512, 2, 2.2500000000000000, 0.0},
    {0.63822210253698464, 2, 2.5000000000000000, 0.0},
    {0.84077399472838987, 2, 2.7500000000000000, 0.0},
    {1.0965015247007015, 2, 3.0000000000000000, 0.0},
    {1.4189785666158807, 2, 3.2500000000000000, 0.0},
    {1.8253156172672163, 2, 3.5000000000000000, 0.0},
    {2.3370708664492259, 2, 3.7500000000000000, 0.0},
    {2.9814005111442108, 2, 4.0000000000000000, 0.0},
    {3.7925108453347103, 2, 4.2500000000000000, 0.0},
    {4.8134912184214400, 2, 4.5000000000000000, 0.0},
    {6.0986278960713172, 2, 4.7500000000000000, 0.0},
    {7.7163253464501391, 2, 5.0000000000000000, 0.0},
};

const double tolerance_0003 = 1.0000000000000006e-11;

const spherical_modified_bessel_i_fixture<double> fixture_0004[21] = {
    {0.0000000000000000, 5, 0.0000000000000000, 0.0},
    {9.4171472133463046e-08, 5, 0.25000000000000000, 0.0},
    {3.0352800236771821e-06, 5, 0.50000000000000000, 0.0},
    {2.3327280497022086e-05, 5, 0.75000000000000000, 0.0},
    {9.9962375200682578e-05, 5, 1.0000000000000000, 0.0},
    {0.00031168895164743486, 5, 1.2500000000000000, 0.0},
    {0.00079616126546980877, 5, 1.5000000000000000, 0.0},
    {0.0017747050338246357, 5, 1.7500000000000000, 0.0},
    {0.0035848483012706554, 5, 2.0000000000000000, 0.0},
    {0.0067233360901894374, 5, 2.2500000000000000, 0.0},
    {0.011903108529394534, 5, 2.5000000000000000, 0.0},
    {0.020128726077894971, 5, 2.7500000000000000, 0.0},
    {0.032796038709344499, 5, 3.0000000000000000, 0.0},
    {0.051823605198948984, 5, 3.2500000000000000, 0.0},
    {0.079825586295274878, 5, 3.5000000000000000, 0.0},
    {0.12033870666452307, 5, 3.7500000000000000, 0.0},
    {0.17811959211406245, 5, 4.0000000000000000, 0.0},
    {0.25953358154962841, 5, 4.2500000000000000, 0.0},
    {0.37306229715276235, 5, 4.5000000000000000, 0.0},
    {0.52996522956073666, 5, 4.7500000000000000, 0.0},
    {0.74514086898323684, 5, 5.0000000000000000, 0.0},
};

const double tolerance_0004 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0005[21] = {
    {0.0000000000000000, 10, 0.0000000000000000, 0.0},
    {6.9455910134736489e-17, 10, 0.25000000000000000, 0.0},
    {7.1413267490447504e-14, 10, 0.50000000000000000, 0.0},
    {4.1461001041492784e-12, 10, 0.75000000000000000, 0.0},
    {7.4327935490948244e-11, 10, 1.0000000000000000, 0.0},
    {7.0073059882937007e-10, 10, 1.2500000000000000, 0.0},
    {4.4038545945543764e-09, 10, 1.5000000000000000, 0.0},
    {2.0938072324929076e-08, 10, 1.7500000000000000, 0.0},
    {8.1218232108368801e-08, 10, 2.0000000000000000, 0.0},
    {2.6985601525455940e-07, 10, 2.2500000000000000, 0.0},
    {7.9398098710350478e-07, 10, 2.5000000000000000, 0.0},
    {2.1182777793548696e-06, 10, 2.7500000000000000, 0.0},
    {5.2149461227634122e-06, 10, 3.0000000000000000, 0.0},
    {1.2005477394705086e-05, 10, 3.2500000000000000, 0.0},
    {2.6112795702696844e-05, 10, 3.5000000000000000, 0.0},
    {5.4103086504977776e-05, 10, 3.7500000000000000, 0.0},
    {0.00010748437005138934, 10, 4.0000000000000000, 0.0},
    {0.00020585438846387744, 10, 4.2500000000000000, 0.0},
    {0.00038176853054520222, 10, 4.5000000000000000, 0.0},
    {0.00068814966957889026, 10, 4.7500000000000000, 0.0},
    {0.0012094137020295750, 10, 5.0000000000000000, 0.0},
};

const double tolerance_0005 = 5.0000000000000039e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0006[21] = {
    {0.0000000000000000, 20, 0.0000000000000000, 0.0},
    {6.9408297945994195e-38, 20, 0.25000000000000000, 0.0},
    {7.2938712744408843e-32, 20, 0.50000000000000000, 0.0},
    {2.4342268546667399e-28, 20, 0.75000000000000000, 0.0},
    {7.7151475650656277e-26, 20, 1.0000000000000000, 0.0},
    {6.7357073162387499e-24, 20, 1.2500000000000000, 0.0},
    {2.6030142509881885e-22, 20, 1.5000000000000000, 0.0},
    {5.7346879859110794e-21, 20, 1.7500000000000000, 0.0},
    {8.3767284780476072e-20, 20, 2.0000000000000000, 0.0},
    {8.9428909687935883e-19, 20, 2.2500000000000000, 0.0},
    {7.4577378687525042e-18, 20, 2.5000000000000000, 0.0},
    {5.0940753287918243e-17, 20, 2.7500000000000000, 0.0},
    {2.9516512905661486e-16, 20, 3.0000000000000000, 0.0},
    {1.4899036869887540e-15, 20, 3.2500000000000000, 0.0},
    {6.6884264572181021e-15, 20, 3.5000000000000000, 0.0},
    {2.7144384541176341e-14, 20, 3.7500000000000000, 0.0},
    {1.0091688321190754e-13, 20, 4.0000000000000000, 0.0},
    {3.4743049759286458e-13, 20, 4.2500000000000000, 0.0},
    {1.1175810139215688e-12, 20, 4.5000000000000000, 0.0},
    {3.3841717065506007e-12, 20, 4.7500000000000000, 0.0},
    {9.7082664411470080e-12, 20, 5.0000000000000000, 0.0},
};

const double tolerance_0006 = 2.5000000000000015e-12;

const spherical_modified_bessel_i_fixture<double> fixture_0007[21] = {
    {1.0000000000000000, 0, 0.0000000000000000, 0.0},
    {14.840642115557751, 0, 5.0000000000000000, 0.0},
    {1101.3232874703394, 0, 10.000000000000000, 0.0},
    {108967.24574906015, 0, 15.000000000000000, 0.0},
    {12129129.885244757, 0, 20.000000000000000, 0.0},
    {1440097986.7477176, 0, 25.000000000000000, 0.0},
    {178107909692.07437, 0, 30.000000000000000, 0.0},
    {22657335033049.012, 0, 35.000000000000000, 0.0},
    {2942315835462750.0, 0, 40.000000000000000, 0.0},
    {3.8815856730538995e+17, 0, 45.000000000000000, 0.0},
    {5.1847055285870723e+19, 0, 50.000000000000000, 0.0},
    {6.9952593319472881e+21, 0, 55.000000000000000, 0.0},
    {9.5167282484640354e+23, 0, 60.000000000000000, 0.0},
    {1.3037609572387184e+26, 0, 65.000000000000000, 0.0},
    {1.7967419077994048e+28, 0, 70.000000000000000, 0.0},
    {2.4888279978660011e+30, 0, 75.000000000000000, 0.0},
    {3.4628889902459435e+32, 0, 80.000000000000000, 0.0},
    {4.8370663027193602e+34, 0, 85.000000000000000, 0.0},
    {6.7800183017657825e+36, 0, 90.000000000000000, 0.0},
    {9.5328372783632798e+38, 0, 95.000000000000000, 0.0},
    {1.3440585709080679e+41, 0, 100.00000000000000, 0.0},
};

const double tolerance_0007 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0008[21] = {
    {0.0000000000000000, 1, 0.0000000000000000, 0.0},
    {11.873861281846017, 1, 5.0000000000000000, 0.0},
    {991.19096326329839, 1, 10.000000000000000, 0.0},
    {101702.76269914319, 1, 15.000000000000000, 0.0},
    {11522673.390982520, 1, 20.000000000000000, 0.0},
    {1382494067.2778087, 1, 25.000000000000000, 0.0},
    {172170979369.00522, 1, 30.000000000000000, 0.0},
    {22009982603533.324, 1, 35.000000000000000, 0.0},
    {2868757939576181.5, 1, 40.000000000000000, 0.0},
    {3.7953282136527014e+17, 1, 45.000000000000000, 0.0},
    {5.0810114180153303e+19, 1, 50.000000000000000, 0.0},
    {6.8680727986391566e+21, 1, 55.000000000000000, 0.0},
    {9.3581161109896353e+23, 1, 60.000000000000000, 0.0},
    {1.2837030963581226e+26, 1, 65.000000000000000, 0.0},
    {1.7710741662594135e+28, 1, 70.000000000000000, 0.0},
    {2.4556436245611209e+30, 1, 75.000000000000000, 0.0},
    {3.4196028778678696e+32, 1, 80.000000000000000, 0.0},
    {4.7801596403344268e+34, 1, 85.000000000000000, 0.0},
    {6.7046847650794962e+36, 1, 90.000000000000000, 0.0},
    {9.4324916228015628e+38, 1, 95.000000000000000, 0.0},
    {1.3306179851989872e+41, 1, 100.00000000000000, 0.0},
};

const double tolerance_0008 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0009[21] = {
    {0.0000000000000000, 2, 0.0000000000000000, 0.0},
    {7.7163253464501391, 2, 5.0000000000000000, 0.0},
    {803.96599849134986, 2, 10.000000000000000, 0.0},
    {88626.693209231511, 2, 15.000000000000000, 0.0},
    {10400728.876597380, 2, 20.000000000000000, 0.0},
    {1274198698.6743805, 2, 25.000000000000000, 0.0},
    {160890811755.17386, 2, 30.000000000000000, 0.0},
    {20770765095603.297, 2, 35.000000000000000, 0.0},
    {2727158989994536.5, 2, 40.000000000000000, 0.0},
    {3.6285637921437190e+17, 2, 45.000000000000000, 0.0},
    {4.8798448435061522e+19, 2, 50.000000000000000, 0.0},
    {6.6206371792942436e+21, 2, 55.000000000000000, 0.0},
    {9.0488224429145526e+23, 2, 60.000000000000000, 0.0},
    {1.2445131220221894e+26, 2, 65.000000000000000, 0.0},
    {1.7208387292454300e+28, 2, 70.000000000000000, 0.0},
    {2.3906022528835561e+30, 2, 75.000000000000000, 0.0},
    {3.3346538823258986e+32, 2, 80.000000000000000, 0.0},
    {4.6683547860016748e+34, 2, 85.000000000000000, 0.0},
    {6.5565288095964660e+36, 2, 90.000000000000000, 0.0},
    {9.2349691218537563e+38, 2, 95.000000000000000, 0.0},
    {1.3041400313520982e+41, 2, 100.00000000000000, 0.0},
};

const double tolerance_0009 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0010[21] = {
    {0.0000000000000000, 5, 0.0000000000000000, 0.0},
    {0.74514086898323684, 5, 5.0000000000000000, 0.0},
    {236.83958270651149, 5, 10.000000000000000, 0.0},
    {39189.464560092289, 5, 15.000000000000000, 0.0},
    {5647455.5369280791, 5, 20.000000000000000, 0.0},
    {782610352.23648345, 5, 25.000000000000000, 0.0},
    {107263509635.27744, 5, 30.000000000000000, 0.0},
    {14681016988281.531, 5, 35.000000000000000, 0.0},
    {2013786901295026.0, 5, 40.000000000000000, 0.0},
    {2.7719753948203904e+17, 5, 45.000000000000000, 0.0},
    {3.8303991405619569e+19, 5, 50.000000000000000, 0.0},
    {5.3133223072353778e+21, 5, 55.000000000000000, 0.0},
    {7.3972950401893030e+23, 5, 60.000000000000000, 0.0},
    {1.0333682447551636e+26, 5, 65.000000000000000, 0.0},
    {1.4480970118782314e+28, 5, 70.000000000000000, 0.0},
    {2.0351160962691218e+30, 5, 75.000000000000000, 0.0},
    {2.8676485705927154e+32, 5, 80.000000000000000, 0.0},
    {4.0505412996258305e+34, 5, 85.000000000000000, 0.0},
    {5.7340947637554077e+36, 5, 90.000000000000000, 0.0},
    {8.1340004124710344e+38, 5, 95.000000000000000, 0.0},
    {1.1560104700065719e+41, 5, 100.00000000000000, 0.0},
};

const double tolerance_0010 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0011[21] = {
    {0.0000000000000000, 10, 0.0000000000000000, 0.0},
    {0.0012094137020295750, 10, 5.0000000000000000, 0.0},
    {5.4645416534307270, 10, 10.000000000000000, 0.0},
    {2861.0331940403880, 10, 15.000000000000000, 0.0},
    {771563.89291744551, 10, 20.000000000000000, 0.0},
    {157771503.93992111, 10, 25.000000000000000, 0.0},
    {28144334181.074596, 10, 30.000000000000000, 0.0},
    {4657227944744.3965, 10, 35.000000000000000, 0.0},
    {737041543321430.62, 10, 40.000000000000000, 0.0},
    {1.1342284777394482e+17, 10, 45.000000000000000, 0.0},
    {1.7138050710910188e+19, 10, 50.000000000000000, 0.0},
    {2.5577794589282691e+21, 10, 55.000000000000000, 0.0},
    {3.7850074613897759e+23, 10, 60.000000000000000, 0.0},
    {5.5676977654845755e+25, 10, 65.000000000000000, 0.0},
    {8.1553674628717877e+27, 10, 70.000000000000000, 0.0},
    {1.1909606908007732e+30, 10, 75.000000000000000, 0.0},
    {1.7354540436481580e+32, 10, 80.000000000000000, 0.0},
    {2.5250090405342468e+34, 10, 85.000000000000000, 0.0},
    {3.6698383870211543e+36, 10, 90.000000000000000, 0.0},
    {5.3298346538524537e+38, 10, 95.000000000000000, 0.0},
    {7.7370381755353228e+40, 10, 100.00000000000000, 0.0},
};

const double tolerance_0011 = 2.5000000000000020e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0012[21] = {
    {0.0000000000000000, 20, 0.0000000000000000, 0.0},
    {9.7082664411470080e-12, 20, 5.0000000000000000, 0.0},
    {2.3715435772561034e-05, 20, 10.000000000000000, 0.0},
    {0.30373354585337614, 20, 15.000000000000000, 0.0},
    {568.99642862605708, 20, 20.000000000000000, 0.0},
    {421966.07426167920, 20, 25.000000000000000, 0.0},
    {187264896.79220429, 20, 30.000000000000000, 0.0},
    {60882521775.809013, 20, 35.000000000000000, 0.0},
    {16186700699206.576, 20, 40.000000000000000, 0.0},
    {3753832736503227.0, 20, 45.000000000000000, 0.0},
    {7.9043041037673946e+17, 20, 50.000000000000000, 0.0},
    {1.5512135584359530e+20, 20, 55.000000000000000, 0.0},
    {2.8878682557035871e+22, 20, 60.000000000000000, 0.0},
    {5.1635197653100037e+24, 20, 65.000000000000000, 0.0},
    {8.9459878460375228e+26, 20, 70.000000000000000, 0.0},
    {1.5116619061153994e+29, 20, 75.000000000000000, 0.0},
    {2.5034952555111180e+31, 20, 80.000000000000000, 0.0},
    {4.0787202720664013e+33, 20, 85.000000000000000, 0.0},
    {6.5560361199881929e+35, 20, 90.000000000000000, 0.0},
    {1.0420428850962377e+38, 20, 95.000000000000000, 0.0},
    {1.6407475505991209e+40, 20, 100.00000000000000, 0.0},
};

const double tolerance_0012 = 5.0000000000000039e-13;

const spherical_modified_bessel_i_fixture<double> fixture_0013[21] = {
    {0.0000000000000000, 50, 0.0000000000000000, 0.0},
    {3.6424596640346326e-46, 50, 5.0000000000000000, 0.0},
    {5.8899161540502472e-31, 50, 10.000000000000000, 0.0},
    {6.8290220091889981e-22, 50, 15.000000000000000, 0.0},
    {2.7551965739613184e-15, 50, 20.000000000000000, 0.0},
    {5.4881735170878801e-10, 50, 25.000000000000000, 0.0},
    {1.7468643118038990e-05, 50, 30.000000000000000, 0.0},
    {0.16521306046026848, 50, 35.000000000000000, 0.0},
    {668.79008464922572, 50, 40.000000000000000, 0.0},
    {1459902.8720297134, 50, 45.000000000000000, 0.0},
    {2004898633.2778776, 50, 50.000000000000000, 0.0},
    {1927930196346.2388, 50, 55.000000000000000, 0.0},
    {1401687083158961.8, 50, 60.000000000000000, 0.0},
    {8.1524444290770266e+17, 50, 65.000000000000000, 0.0},
    {3.9575544662279809e+20, 50, 70.000000000000000, 0.0},
    {1.6564285518509375e+23, 50, 75.000000000000000, 0.0},
    {6.1304983763933921e+25, 50, 80.000000000000000, 0.0},
    {2.0466782848768234e+28, 50, 85.000000000000000, 0.0},
    {6.2624687960600826e+30, 50, 90.000000000000000, 0.0},
    {1.7789593692158918e+33, 50, 95.000000000000000, 0.0},
    {4.7409509594941738e+35, 50, 100.00000000000000, 0.0},
};

const double tolerance_0013 = 5.0000000000000029e-12;

const spherical_modified_bessel_i_fixture<double> fixture_0014[21] = {
    {0.0000000000000000, 100, 0.0000000000000000, 0.0},
    {6.2611369328234633e-120, 100, 5.0000000000000000, 0.0},
    {9.5446386609093746e-90, 100, 10.000000000000000, 0.0},
    {5.2732556191626321e-72, 100, 15.000000000000000, 0.0},
    {2.5221082180182095e-59, 100, 20.000000000000000, 0.0},
    {2.1406844749415110e-49, 100, 25.000000000000000, 0.0},
    {3.4485888797252755e-41, 100, 30.000000000000000, 0.0},
    {3.7283725278751719e-34, 100, 35.000000000000000, 0.0},
    {5.7422544260210549e-28, 100, 40.000000000000000, 0.0},
    {2.0450469578641674e-22, 100, 45.000000000000000, 0.0},
    {2.3418937401088263e-17, 100, 50.000000000000000, 0.0},
    {1.0898764694486447e-12, 100, 55.000000000000000, 0.0},
    {2.4481305851647831e-08, 100, 60.000000000000000, 0.0},
    {0.00030220938075344972, 100, 65.000000000000000, 0.0},
    {2.2661374734011708, 100, 70.000000000000000, 0.0},
    {11167.305724756836, 100, 75.000000000000000, 0.0},
    {38510672.874965981, 100, 80.000000000000000, 0.0},
    {97783146557.016205, 100, 85.000000000000000, 0.0},
    {190578297921468.88, 100, 90.000000000000000, 0.0},
    {2.9509429116573683e+17, 100, 95.000000000000000, 0.0},
    {3.7359887415969533e+20, 100, 100.00000000000000, 0.0},
};

const double tolerance_0014 = 2.5000000000000014e-11;

template<typename T1, unsigned int T2>
void
test(const spherical_modified_bessel_i_fixture<T1>(&fixtures)[T2], T1 tolerance) {
  const T1 epsilon = std::numeric_limits<T1>::epsilon();

  T1 maximum_absolute_difference = T1(-1);
  T1 maximum_absolute_fraction = T1(-1);

  auto error = 0;

  for (auto fixture: fixtures) {
    const T1 g = aten::native::special_functions::spherical_modified_bessel_i(fixture.n, fixture.x);

    if (std::isnan(g) && !error) {
      error = 1;
    }

    if (!std::isnan(g)) {
      const T1 f = fixture.f0;

      const auto difference = g - f;

      const auto absolute_difference = std::abs(difference);

      if (absolute_difference > maximum_absolute_difference) {
        maximum_absolute_difference = absolute_difference;
      }

      const auto abs_f = std::abs(f);
      const auto abs_g = std::abs(g);

      if (abs_f > T1(10) * epsilon && abs_g > T1(10) * epsilon) {
        const auto fraction = difference / f;

        const auto absolute_fraction = std::abs(fraction);

        if (absolute_fraction > maximum_absolute_fraction) {
          maximum_absolute_fraction = absolute_fraction;
        }
      }
    }
  }

  EXPECT_TRUE(!error && maximum_absolute_fraction < tolerance);
}

TEST(SphericalModifiedBesselITest, GSL) {
  test(fixture_0001, tolerance_0001);
  test(fixture_0002, tolerance_0002);
  test(fixture_0003, tolerance_0003);
  test(fixture_0004, tolerance_0004);
  test(fixture_0005, tolerance_0005);
  test(fixture_0006, tolerance_0006);
  test(fixture_0007, tolerance_0007);
  test(fixture_0008, tolerance_0008);
  test(fixture_0009, tolerance_0009);
  test(fixture_0010, tolerance_0010);
  test(fixture_0011, tolerance_0011);
  test(fixture_0012, tolerance_0012);
  test(fixture_0013, tolerance_0013);
  test(fixture_0014, tolerance_0014);
}
