#include <gtest/gtest.h>
#include <ATen/native/special_functions/theta_2.h>

template<typename T1>
struct theta_2_fixture {
  T1 f0;
  T1 n;
  T1 x;
  T1 f;
};

const theta_2_fixture<double> fixture_0001[40] = {
    {2.52313251161903e+00, 0.0, 5.00000000000000e-02, 0.0},
    {1.78396211793365e+00, 0.0, 1.00000000000000e-01, 0.0},
    {1.45302346996409e+00, 0.0, 1.50000000000000e-01, 0.0},
    {1.24456553300560e+00, 0.0, 2.00000000000000e-01, 0.0},
    {1.08704545035202e+00, 0.0, 2.50000000000000e-01, 0.0},
    {9.56574844303076e-01, 0.0, 3.00000000000000e-01, 0.0},
    {8.44133459452248e-01, 0.0, 3.50000000000000e-01, 0.0},
    {7.45693231264826e-01, 0.0, 4.00000000000000e-01, 0.0},
    {6.58991562910504e-01, 0.0, 4.50000000000000e-01, 0.0},
    {5.82455991349662e-01, 0.0, 5.00000000000000e-01, 0.0},
    {5.14837404730157e-01, 0.0, 5.50000000000000e-01, 0.0},
    {4.55078068921155e-01, 0.0, 6.00000000000000e-01, 0.0},
    {4.02258301064429e-01, 0.0, 6.50000000000000e-01, 0.0},
    {3.55570196200305e-01, 0.0, 7.00000000000000e-01, 0.0},
    {3.14301276853057e-01, 0.0, 7.50000000000000e-01, 0.0},
    {2.77822304803579e-01, 0.0, 8.00000000000000e-01, 0.0},
    {2.45577253510372e-01, 0.0, 8.50000000000000e-01, 0.0},
    {2.17074690149376e-01, 0.0, 9.00000000000000e-01, 0.0},
    {1.91880238857644e-01, 0.0, 9.50000000000000e-01, 0.0},
    {1.69609945395983e-01, 0.0, 1.00000000000000e+00, 0.0},
    {1.49924420720702e-01, 0.0, 1.05000000000000e+00, 0.0},
    {1.32523667168356e-01, 0.0, 1.10000000000000e+00, 0.0},
    {1.17142506085500e-01, 0.0, 1.15000000000000e+00, 0.0},
    {1.03546536458016e-01, 0.0, 1.20000000000000e+00, 0.0},
    {9.15285626996051e-02, 0.0, 1.25000000000000e+00, 0.0},
    {8.09054370777767e-02, 0.0, 1.30000000000000e+00, 0.0},
    {7.15152686301702e-02, 0.0, 1.35000000000000e+00, 0.0},
    {6.32149560275312e-02, 0.0, 1.40000000000000e+00, 0.0},
    {5.58780067824712e-02, 0.0, 1.45000000000000e+00, 0.0},
    {4.93926095689015e-02, 0.0, 1.50000000000000e+00, 0.0},
};

const double tolerance_0001 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0002[40] = {
    {1.13370955665395e+00, 0.2, 5.00000000000000e-02, 0.0},
    {1.19296874081780e+00, 0.2, 1.00000000000000e-01, 0.0},
    {1.09521737080606e+00, 0.2, 1.50000000000000e-01, 0.0},
    {9.80517122478914e-01, 0.2, 2.00000000000000e-01, 0.0},
    {8.70759250532067e-01, 0.2, 2.50000000000000e-01, 0.0},
    {7.71026216869540e-01, 0.2, 3.00000000000000e-01, 0.0},
    {6.81976396743660e-01, 0.2, 3.50000000000000e-01, 0.0},
    {6.02968182345536e-01, 0.2, 4.00000000000000e-01, 0.0},
    {5.33033140486307e-01, 0.2, 4.50000000000000e-01, 0.0},
    {4.71183114791048e-01, 0.2, 5.00000000000000e-01, 0.0},
    {4.16501113662449e-01, 0.2, 5.50000000000000e-01, 0.0},
    {3.68162235912359e-01, 0.2, 6.00000000000000e-01, 0.0},
    {3.25432597347857e-01, 0.2, 6.50000000000000e-01, 0.0},
    {2.87661934648847e-01, 0.2, 7.00000000000000e-01, 0.0},
    {2.54274943611824e-01, 0.2, 7.50000000000000e-01, 0.0},
    {2.24762922938103e-01, 0.2, 8.00000000000000e-01, 0.0},
    {1.98676157334243e-01, 0.2, 8.50000000000000e-01, 0.0},
    {1.75617108705424e-01, 0.2, 9.00000000000000e-01, 0.0},
    {1.55234372580677e-01, 0.2, 9.50000000000000e-01, 0.0},
    {1.37217327733043e-01, 0.2, 1.00000000000000e+00, 0.0},
    {1.21291404067733e-01, 0.2, 1.05000000000000e+00, 0.0},
    {1.07213898841027e-01, 0.2, 1.10000000000000e+00, 0.0},
    {9.47702781687001e-02, 0.2, 1.15000000000000e+00, 0.0},
    {8.37709076972236e-02, 0.2, 1.20000000000000e+00, 0.0},
    {7.40481626927245e-02, 0.2, 1.25000000000000e+00, 0.0},
    {6.54538735326057e-02, 0.2, 1.30000000000000e+00, 0.0},
    {5.78570676788836e-02, 0.2, 1.35000000000000e+00, 0.0},
    {5.11419737248673e-02, 0.2, 1.40000000000000e+00, 0.0},
    {4.52062570987946e-02, 0.2, 1.45000000000000e+00, 0.0},
    {3.99594605377603e-02, 0.2, 1.50000000000000e+00, 0.0},
};

const double tolerance_0002 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0003[40] = {
    {1.00964707593441e-01, 0.4, 5.00000000000000e-02, 0.0},
    {3.11459529087888e-01, 0.4, 1.00000000000000e-01, 0.0},
    {3.69184872387211e-01, 0.4, 1.50000000000000e-01, 0.0},
    {3.58256287893023e-01, 0.4, 2.00000000000000e-01, 0.0},
    {3.27237529054472e-01, 0.4, 2.50000000000000e-01, 0.0},
    {2.92738840651539e-01, 0.4, 3.00000000000000e-01, 0.0},
    {2.59909669119651e-01, 0.4, 3.50000000000000e-01, 0.0},
    {2.30121566809325e-01, 0.4, 4.00000000000000e-01, 0.0},
    {2.03537359035458e-01, 0.4, 4.50000000000000e-01, 0.0},
    {1.79955119116419e-01, 0.4, 5.00000000000000e-01, 0.0},
    {1.59082411297380e-01, 0.4, 5.50000000000000e-01, 0.0},
    {1.40623201451782e-01, 0.4, 6.00000000000000e-01, 0.0},
    {1.24303446815642e-01, 0.4, 6.50000000000000e-01, 0.0},
    {1.09876836548695e-01, 0.4, 7.00000000000000e-01, 0.0},
    {9.71243051852960e-02, 0.4, 7.50000000000000e-01, 0.0},
    {8.58517705363137e-02, 0.4, 8.00000000000000e-01, 0.0},
    {7.58875305790574e-02, 0.4, 8.50000000000000e-01, 0.0},
    {6.70797636307366e-02, 0.4, 9.00000000000000e-01, 0.0},
    {5.92942531518548e-02, 0.4, 9.50000000000000e-01, 0.0},
    {5.24123550350516e-02, 0.4, 1.00000000000000e+00, 0.0},
    {4.63291937073818e-02, 0.4, 1.05000000000000e+00, 0.0},
    {4.09520652568488e-02, 0.4, 1.10000000000000e+00, 0.0},
    {3.61990251259500e-02, 0.4, 1.15000000000000e+00, 0.0},
    {3.19976394682157e-02, 0.4, 1.20000000000000e+00, 0.0},
    {2.82838813429220e-02, 0.4, 1.25000000000000e+00, 0.0},
    {2.50011549937173e-02, 0.4, 1.30000000000000e+00, 0.0},
    {2.20994333637985e-02, 0.4, 1.35000000000000e+00, 0.0},
    {1.95344957111018e-02, 0.4, 1.40000000000000e+00, 0.0},
    {1.72672537075590e-02, 0.4, 1.45000000000000e+00, 0.0},
    {1.52631557533096e-02, 0.4, 1.50000000000000e+00, 0.0},
};

const double tolerance_0003 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0004[40] = {
    {-1.00964707593442e-01, 0.6, 5.00000000000000e-02, 0.0},
    {-3.11459529087889e-01, 0.6, 1.00000000000000e-01, 0.0},
    {-3.69184872387211e-01, 0.6, 1.50000000000000e-01, 0.0},
    {-3.58256287893023e-01, 0.6, 2.00000000000000e-01, 0.0},
    {-3.27237529054472e-01, 0.6, 2.50000000000000e-01, 0.0},
    {-2.92738840651539e-01, 0.6, 3.00000000000000e-01, 0.0},
    {-2.59909669119651e-01, 0.6, 3.50000000000000e-01, 0.0},
    {-2.30121566809325e-01, 0.6, 4.00000000000000e-01, 0.0},
    {-2.03537359035458e-01, 0.6, 4.50000000000000e-01, 0.0},
    {-1.79955119116419e-01, 0.6, 5.00000000000000e-01, 0.0},
    {-1.59082411297380e-01, 0.6, 5.50000000000000e-01, 0.0},
    {-1.40623201451782e-01, 0.6, 6.00000000000000e-01, 0.0},
    {-1.24303446815642e-01, 0.6, 6.50000000000000e-01, 0.0},
    {-1.09876836548695e-01, 0.6, 7.00000000000000e-01, 0.0},
    {-9.71243051852960e-02, 0.6, 7.50000000000000e-01, 0.0},
    {-8.58517705363137e-02, 0.6, 8.00000000000000e-01, 0.0},
    {-7.58875305790574e-02, 0.6, 8.50000000000000e-01, 0.0},
    {-6.70797636307366e-02, 0.6, 9.00000000000000e-01, 0.0},
    {-5.92942531518548e-02, 0.6, 9.50000000000000e-01, 0.0},
    {-5.24123550350516e-02, 0.6, 1.00000000000000e+00, 0.0},
    {-4.63291937073818e-02, 0.6, 1.05000000000000e+00, 0.0},
    {-4.09520652568488e-02, 0.6, 1.10000000000000e+00, 0.0},
    {-3.61990251259500e-02, 0.6, 1.15000000000000e+00, 0.0},
    {-3.19976394682157e-02, 0.6, 1.20000000000000e+00, 0.0},
    {-2.82838813429220e-02, 0.6, 1.25000000000000e+00, 0.0},
    {-2.50011549937173e-02, 0.6, 1.30000000000000e+00, 0.0},
    {-2.20994333637985e-02, 0.6, 1.35000000000000e+00, 0.0},
    {-1.95344957111018e-02, 0.6, 1.40000000000000e+00, 0.0},
    {-1.72672537075590e-02, 0.6, 1.45000000000000e+00, 0.0},
    {-1.52631557533096e-02, 0.6, 1.50000000000000e+00, 0.0},
};

const double tolerance_0004 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0005[40] = {
    {-1.13370955665395e+00, 0.8, 5.00000000000000e-02, 0.0},
    {-1.19296874081780e+00, 0.8, 1.00000000000000e-01, 0.0},
    {-1.09521737080606e+00, 0.8, 1.50000000000000e-01, 0.0},
    {-9.80517122478914e-01, 0.8, 2.00000000000000e-01, 0.0},
    {-8.70759250532067e-01, 0.8, 2.50000000000000e-01, 0.0},
    {-7.71026216869540e-01, 0.8, 3.00000000000000e-01, 0.0},
    {-6.81976396743660e-01, 0.8, 3.50000000000000e-01, 0.0},
    {-6.02968182345536e-01, 0.8, 4.00000000000000e-01, 0.0},
    {-5.33033140486307e-01, 0.8, 4.50000000000000e-01, 0.0},
    {-4.71183114791048e-01, 0.8, 5.00000000000000e-01, 0.0},
    {-4.16501113662449e-01, 0.8, 5.50000000000000e-01, 0.0},
    {-3.68162235912359e-01, 0.8, 6.00000000000000e-01, 0.0},
    {-3.25432597347857e-01, 0.8, 6.50000000000000e-01, 0.0},
    {-2.87661934648847e-01, 0.8, 7.00000000000000e-01, 0.0},
    {-2.54274943611824e-01, 0.8, 7.50000000000000e-01, 0.0},
    {-2.24762922938103e-01, 0.8, 8.00000000000000e-01, 0.0},
    {-1.98676157334243e-01, 0.8, 8.50000000000000e-01, 0.0},
    {-1.75617108705424e-01, 0.8, 9.00000000000000e-01, 0.0},
    {-1.55234372580677e-01, 0.8, 9.50000000000000e-01, 0.0},
    {-1.37217327733043e-01, 0.8, 1.00000000000000e+00, 0.0},
    {-1.21291404067733e-01, 0.8, 1.05000000000000e+00, 0.0},
    {-1.07213898841027e-01, 0.8, 1.10000000000000e+00, 0.0},
    {-9.47702781687001e-02, 0.8, 1.15000000000000e+00, 0.0},
    {-8.37709076972236e-02, 0.8, 1.20000000000000e+00, 0.0},
    {-7.40481626927245e-02, 0.8, 1.25000000000000e+00, 0.0},
    {-6.54538735326057e-02, 0.8, 1.30000000000000e+00, 0.0},
    {-5.78570676788836e-02, 0.8, 1.35000000000000e+00, 0.0},
    {-5.11419737248673e-02, 0.8, 1.40000000000000e+00, 0.0},
    {-4.52062570987946e-02, 0.8, 1.45000000000000e+00, 0.0},
    {-3.99594605377603e-02, 0.8, 1.50000000000000e+00, 0.0},
};

const double tolerance_0005 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0006[40] = {
    {-2.52313251161903e+00, 1.0, 5.00000000000000e-02, 0.0},
    {-1.78396211793365e+00, 1.0, 1.00000000000000e-01, 0.0},
    {-1.45302346996409e+00, 1.0, 1.50000000000000e-01, 0.0},
    {-1.24456553300560e+00, 1.0, 2.00000000000000e-01, 0.0},
    {-1.08704545035202e+00, 1.0, 2.50000000000000e-01, 0.0},
    {-9.56574844303076e-01, 1.0, 3.00000000000000e-01, 0.0},
    {-8.44133459452248e-01, 1.0, 3.50000000000000e-01, 0.0},
    {-7.45693231264826e-01, 1.0, 4.00000000000000e-01, 0.0},
    {-6.58991562910504e-01, 1.0, 4.50000000000000e-01, 0.0},
    {-5.82455991349662e-01, 1.0, 5.00000000000000e-01, 0.0},
    {-5.14837404730157e-01, 1.0, 5.50000000000000e-01, 0.0},
    {-4.55078068921155e-01, 1.0, 6.00000000000000e-01, 0.0},
    {-4.02258301064429e-01, 1.0, 6.50000000000000e-01, 0.0},
    {-3.55570196200305e-01, 1.0, 7.00000000000000e-01, 0.0},
    {-3.14301276853057e-01, 1.0, 7.50000000000000e-01, 0.0},
    {-2.77822304803579e-01, 1.0, 8.00000000000000e-01, 0.0},
    {-2.45577253510372e-01, 1.0, 8.50000000000000e-01, 0.0},
    {-2.17074690149376e-01, 1.0, 9.00000000000000e-01, 0.0},
    {-1.91880238857644e-01, 1.0, 9.50000000000000e-01, 0.0},
    {-1.69609945395983e-01, 1.0, 1.00000000000000e+00, 0.0},
    {-1.49924420720702e-01, 1.0, 1.05000000000000e+00, 0.0},
    {-1.32523667168356e-01, 1.0, 1.10000000000000e+00, 0.0},
    {-1.17142506085500e-01, 1.0, 1.15000000000000e+00, 0.0},
    {-1.03546536458016e-01, 1.0, 1.20000000000000e+00, 0.0},
    {-9.15285626996051e-02, 1.0, 1.25000000000000e+00, 0.0},
    {-8.09054370777767e-02, 1.0, 1.30000000000000e+00, 0.0},
    {-7.15152686301702e-02, 1.0, 1.35000000000000e+00, 0.0},
    {-6.32149560275312e-02, 1.0, 1.40000000000000e+00, 0.0},
    {-5.58780067824712e-02, 1.0, 1.45000000000000e+00, 0.0},
    {-4.93926095689015e-02, 1.0, 1.50000000000000e+00, 0.0},
};

const double tolerance_0006 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0007[40] = {
    {-1.13370955665395e+00, 1.2, 5.00000000000000e-02, 0.0},
    {-1.19296874081780e+00, 1.2, 1.00000000000000e-01, 0.0},
    {-1.09521737080606e+00, 1.2, 1.50000000000000e-01, 0.0},
    {-9.80517122478914e-01, 1.2, 2.00000000000000e-01, 0.0},
    {-8.70759250532067e-01, 1.2, 2.50000000000000e-01, 0.0},
    {-7.71026216869540e-01, 1.2, 3.00000000000000e-01, 0.0},
    {-6.81976396743660e-01, 1.2, 3.50000000000000e-01, 0.0},
    {-6.02968182345536e-01, 1.2, 4.00000000000000e-01, 0.0},
    {-5.33033140486307e-01, 1.2, 4.50000000000000e-01, 0.0},
    {-4.71183114791048e-01, 1.2, 5.00000000000000e-01, 0.0},
    {-4.16501113662449e-01, 1.2, 5.50000000000000e-01, 0.0},
    {-3.68162235912359e-01, 1.2, 6.00000000000000e-01, 0.0},
    {-3.25432597347857e-01, 1.2, 6.50000000000000e-01, 0.0},
    {-2.87661934648847e-01, 1.2, 7.00000000000000e-01, 0.0},
    {-2.54274943611824e-01, 1.2, 7.50000000000000e-01, 0.0},
    {-2.24762922938103e-01, 1.2, 8.00000000000000e-01, 0.0},
    {-1.98676157334243e-01, 1.2, 8.50000000000000e-01, 0.0},
    {-1.75617108705424e-01, 1.2, 9.00000000000000e-01, 0.0},
    {-1.55234372580677e-01, 1.2, 9.50000000000000e-01, 0.0},
    {-1.37217327733043e-01, 1.2, 1.00000000000000e+00, 0.0},
    {-1.21291404067733e-01, 1.2, 1.05000000000000e+00, 0.0},
    {-1.07213898841027e-01, 1.2, 1.10000000000000e+00, 0.0},
    {-9.47702781687001e-02, 1.2, 1.15000000000000e+00, 0.0},
    {-8.37709076972236e-02, 1.2, 1.20000000000000e+00, 0.0},
    {-7.40481626927245e-02, 1.2, 1.25000000000000e+00, 0.0},
    {-6.54538735326057e-02, 1.2, 1.30000000000000e+00, 0.0},
    {-5.78570676788836e-02, 1.2, 1.35000000000000e+00, 0.0},
    {-5.11419737248673e-02, 1.2, 1.40000000000000e+00, 0.0},
    {-4.52062570987946e-02, 1.2, 1.45000000000000e+00, 0.0},
    {-3.99594605377603e-02, 1.2, 1.50000000000000e+00, 0.0},
};

const double tolerance_0007 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0008[40] = {
    {-1.00964707593442e-01, 1.4, 5.00000000000000e-02, 0.0},
    {-3.11459529087889e-01, 1.4, 1.00000000000000e-01, 0.0},
    {-3.69184872387211e-01, 1.4, 1.50000000000000e-01, 0.0},
    {-3.58256287893023e-01, 1.4, 2.00000000000000e-01, 0.0},
    {-3.27237529054472e-01, 1.4, 2.50000000000000e-01, 0.0},
    {-2.92738840651539e-01, 1.4, 3.00000000000000e-01, 0.0},
    {-2.59909669119651e-01, 1.4, 3.50000000000000e-01, 0.0},
    {-2.30121566809325e-01, 1.4, 4.00000000000000e-01, 0.0},
    {-2.03537359035458e-01, 1.4, 4.50000000000000e-01, 0.0},
    {-1.79955119116419e-01, 1.4, 5.00000000000000e-01, 0.0},
    {-1.59082411297380e-01, 1.4, 5.50000000000000e-01, 0.0},
    {-1.40623201451782e-01, 1.4, 6.00000000000000e-01, 0.0},
    {-1.24303446815642e-01, 1.4, 6.50000000000000e-01, 0.0},
    {-1.09876836548695e-01, 1.4, 7.00000000000000e-01, 0.0},
    {-9.71243051852960e-02, 1.4, 7.50000000000000e-01, 0.0},
    {-8.58517705363137e-02, 1.4, 8.00000000000000e-01, 0.0},
    {-7.58875305790574e-02, 1.4, 8.50000000000000e-01, 0.0},
    {-6.70797636307366e-02, 1.4, 9.00000000000000e-01, 0.0},
    {-5.92942531518548e-02, 1.4, 9.50000000000000e-01, 0.0},
    {-5.24123550350516e-02, 1.4, 1.00000000000000e+00, 0.0},
    {-4.63291937073818e-02, 1.4, 1.05000000000000e+00, 0.0},
    {-4.09520652568488e-02, 1.4, 1.10000000000000e+00, 0.0},
    {-3.61990251259500e-02, 1.4, 1.15000000000000e+00, 0.0},
    {-3.19976394682157e-02, 1.4, 1.20000000000000e+00, 0.0},
    {-2.82838813429220e-02, 1.4, 1.25000000000000e+00, 0.0},
    {-2.50011549937173e-02, 1.4, 1.30000000000000e+00, 0.0},
    {-2.20994333637985e-02, 1.4, 1.35000000000000e+00, 0.0},
    {-1.95344957111018e-02, 1.4, 1.40000000000000e+00, 0.0},
    {-1.72672537075590e-02, 1.4, 1.45000000000000e+00, 0.0},
    {-1.52631557533096e-02, 1.4, 1.50000000000000e+00, 0.0},
};

const double tolerance_0008 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0009[40] = {
    {1.00964707593441e-01, 1.6, 5.00000000000000e-02, 0.0},
    {3.11459529087888e-01, 1.6, 1.00000000000000e-01, 0.0},
    {3.69184872387211e-01, 1.6, 1.50000000000000e-01, 0.0},
    {3.58256287893023e-01, 1.6, 2.00000000000000e-01, 0.0},
    {3.27237529054472e-01, 1.6, 2.50000000000000e-01, 0.0},
    {2.92738840651539e-01, 1.6, 3.00000000000000e-01, 0.0},
    {2.59909669119651e-01, 1.6, 3.50000000000000e-01, 0.0},
    {2.30121566809325e-01, 1.6, 4.00000000000000e-01, 0.0},
    {2.03537359035458e-01, 1.6, 4.50000000000000e-01, 0.0},
    {1.79955119116419e-01, 1.6, 5.00000000000000e-01, 0.0},
    {1.59082411297380e-01, 1.6, 5.50000000000000e-01, 0.0},
    {1.40623201451782e-01, 1.6, 6.00000000000000e-01, 0.0},
    {1.24303446815642e-01, 1.6, 6.50000000000000e-01, 0.0},
    {1.09876836548695e-01, 1.6, 7.00000000000000e-01, 0.0},
    {9.71243051852960e-02, 1.6, 7.50000000000000e-01, 0.0},
    {8.58517705363137e-02, 1.6, 8.00000000000000e-01, 0.0},
    {7.58875305790574e-02, 1.6, 8.50000000000000e-01, 0.0},
    {6.70797636307366e-02, 1.6, 9.00000000000000e-01, 0.0},
    {5.92942531518548e-02, 1.6, 9.50000000000000e-01, 0.0},
    {5.24123550350516e-02, 1.6, 1.00000000000000e+00, 0.0},
    {4.63291937073818e-02, 1.6, 1.05000000000000e+00, 0.0},
    {4.09520652568488e-02, 1.6, 1.10000000000000e+00, 0.0},
    {3.61990251259500e-02, 1.6, 1.15000000000000e+00, 0.0},
    {3.19976394682157e-02, 1.6, 1.20000000000000e+00, 0.0},
    {2.82838813429220e-02, 1.6, 1.25000000000000e+00, 0.0},
    {2.50011549937173e-02, 1.6, 1.30000000000000e+00, 0.0},
    {2.20994333637985e-02, 1.6, 1.35000000000000e+00, 0.0},
    {1.95344957111018e-02, 1.6, 1.40000000000000e+00, 0.0},
    {1.72672537075590e-02, 1.6, 1.45000000000000e+00, 0.0},
    {1.52631557533096e-02, 1.6, 1.50000000000000e+00, 0.0},
};

const double tolerance_0009 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0010[40] = {
    {1.13370955665394e+00, 1.8, 5.00000000000000e-02, 0.0},
    {1.19296874081780e+00, 1.8, 1.00000000000000e-01, 0.0},
    {1.09521737080606e+00, 1.8, 1.50000000000000e-01, 0.0},
    {9.80517122478914e-01, 1.8, 2.00000000000000e-01, 0.0},
    {8.70759250532067e-01, 1.8, 2.50000000000000e-01, 0.0},
    {7.71026216869540e-01, 1.8, 3.00000000000000e-01, 0.0},
    {6.81976396743660e-01, 1.8, 3.50000000000000e-01, 0.0},
    {6.02968182345536e-01, 1.8, 4.00000000000000e-01, 0.0},
    {5.33033140486307e-01, 1.8, 4.50000000000000e-01, 0.0},
    {4.71183114791048e-01, 1.8, 5.00000000000000e-01, 0.0},
    {4.16501113662449e-01, 1.8, 5.50000000000000e-01, 0.0},
    {3.68162235912359e-01, 1.8, 6.00000000000000e-01, 0.0},
    {3.25432597347857e-01, 1.8, 6.50000000000000e-01, 0.0},
    {2.87661934648847e-01, 1.8, 7.00000000000000e-01, 0.0},
    {2.54274943611824e-01, 1.8, 7.50000000000000e-01, 0.0},
    {2.24762922938103e-01, 1.8, 8.00000000000000e-01, 0.0},
    {1.98676157334243e-01, 1.8, 8.50000000000000e-01, 0.0},
    {1.75617108705424e-01, 1.8, 9.00000000000000e-01, 0.0},
    {1.55234372580677e-01, 1.8, 9.50000000000000e-01, 0.0},
    {1.37217327733043e-01, 1.8, 1.00000000000000e+00, 0.0},
    {1.21291404067733e-01, 1.8, 1.05000000000000e+00, 0.0},
    {1.07213898841027e-01, 1.8, 1.10000000000000e+00, 0.0},
    {9.47702781687001e-02, 1.8, 1.15000000000000e+00, 0.0},
    {8.37709076972236e-02, 1.8, 1.20000000000000e+00, 0.0},
    {7.40481626927245e-02, 1.8, 1.25000000000000e+00, 0.0},
    {6.54538735326057e-02, 1.8, 1.30000000000000e+00, 0.0},
    {5.78570676788836e-02, 1.8, 1.35000000000000e+00, 0.0},
    {5.11419737248673e-02, 1.8, 1.40000000000000e+00, 0.0},
    {4.52062570987946e-02, 1.8, 1.45000000000000e+00, 0.0},
    {3.99594605377603e-02, 1.8, 1.50000000000000e+00, 0.0},
};

const double tolerance_0010 = 2.5000000000000029e-13;

const theta_2_fixture<double> fixture_0011[40] = {
    {2.52313251161903e+00, 2.0, 5.00000000000000e-02, 0.0},
    {1.78396211793365e+00, 2.0, 1.00000000000000e-01, 0.0},
    {1.45302346996409e+00, 2.0, 1.50000000000000e-01, 0.0},
    {1.24456553300560e+00, 2.0, 2.00000000000000e-01, 0.0},
    {1.08704545035202e+00, 2.0, 2.50000000000000e-01, 0.0},
    {9.56574844303076e-01, 2.0, 3.00000000000000e-01, 0.0},
    {8.44133459452248e-01, 2.0, 3.50000000000000e-01, 0.0},
    {7.45693231264826e-01, 2.0, 4.00000000000000e-01, 0.0},
    {6.58991562910504e-01, 2.0, 4.50000000000000e-01, 0.0},
    {5.82455991349662e-01, 2.0, 5.00000000000000e-01, 0.0},
    {5.14837404730157e-01, 2.0, 5.50000000000000e-01, 0.0},
    {4.55078068921155e-01, 2.0, 6.00000000000000e-01, 0.0},
    {4.02258301064429e-01, 2.0, 6.50000000000000e-01, 0.0},
    {3.55570196200305e-01, 2.0, 7.00000000000000e-01, 0.0},
    {3.14301276853057e-01, 2.0, 7.50000000000000e-01, 0.0},
    {2.77822304803579e-01, 2.0, 8.00000000000000e-01, 0.0},
    {2.45577253510372e-01, 2.0, 8.50000000000000e-01, 0.0},
    {2.17074690149376e-01, 2.0, 9.00000000000000e-01, 0.0},
    {1.91880238857644e-01, 2.0, 9.50000000000000e-01, 0.0},
    {1.69609945395983e-01, 2.0, 1.00000000000000e+00, 0.0},
    {1.49924420720702e-01, 2.0, 1.05000000000000e+00, 0.0},
    {1.32523667168356e-01, 2.0, 1.10000000000000e+00, 0.0},
    {1.17142506085500e-01, 2.0, 1.15000000000000e+00, 0.0},
    {1.03546536458016e-01, 2.0, 1.20000000000000e+00, 0.0},
    {9.15285626996051e-02, 2.0, 1.25000000000000e+00, 0.0},
    {8.09054370777767e-02, 2.0, 1.30000000000000e+00, 0.0},
    {7.15152686301702e-02, 2.0, 1.35000000000000e+00, 0.0},
    {6.32149560275312e-02, 2.0, 1.40000000000000e+00, 0.0},
    {5.58780067824712e-02, 2.0, 1.45000000000000e+00, 0.0},
    {4.93926095689015e-02, 2.0, 1.50000000000000e+00, 0.0},
};

const double tolerance_0011 = 2.5000000000000029e-13;

template<typename T1, unsigned int T2>
void
test(const theta_2_fixture<T1>(&fixtures)[T2], T1 tolerance) {
  const T1 epsilon = std::numeric_limits<T1>::epsilon();

  T1 maximum_absolute_difference = T1(-1);
  T1 maximum_absolute_fraction = T1(-1);

  auto error = 0;

  for (auto fixture: fixtures) {
    const T1 g = aten::native::special_functions::theta_2(fixture.n, fixture.x);

    if (std::isnan(g) && !error) {
      error = 1;
    }

    if (!std::isnan(g)) {
      const T1 f = fixture.f0;

      const auto difference = g - f;

      const auto absolute_difference = std::abs(difference);

      if (absolute_difference > maximum_absolute_difference) {
        maximum_absolute_difference = absolute_difference;
      }

      const auto abs_f = std::abs(f);
      const auto abs_g = std::abs(g);

      if (abs_f > T1(10) * epsilon && abs_g > T1(10) * epsilon) {
        const auto fraction = difference / f;

        const auto absolute_fraction = std::abs(fraction);

        if (absolute_fraction > maximum_absolute_fraction) {
          maximum_absolute_fraction = absolute_fraction;
        }
      }
    }
  }

  EXPECT_TRUE(!error && maximum_absolute_fraction < tolerance);
}

TEST(Theta2Test, GSL) {
  test(fixture_0001, tolerance_0001);
  test(fixture_0002, tolerance_0002);
  test(fixture_0003, tolerance_0003);
  test(fixture_0004, tolerance_0004);
  test(fixture_0005, tolerance_0005);
  test(fixture_0006, tolerance_0006);
  test(fixture_0007, tolerance_0007);
  test(fixture_0008, tolerance_0008);
  test(fixture_0009, tolerance_0009);
  test(fixture_0010, tolerance_0010);
  test(fixture_0011, tolerance_0011);
}
